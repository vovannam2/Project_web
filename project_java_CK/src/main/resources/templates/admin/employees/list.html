<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/layout-admin.html}">

<body>
	<section layout:fragment="content">
		<div class="row" style="padding-top: 10px; padding-bottom:10px;">
			<h1 style="font-size: 27px;">QUẢN LÝ NHÂN VIÊN</h1>
			<form th:action="@{/admin/employees/filter}" method="POST">
				<div class="card mb-4">
					<div class="card-header">
						<i class="fa fa-table me-1"></i>BẢNG DANH SÁCH NHÂN VIÊN
						<button class="btn btn-primary" onclick="exportToExcel()"
							style="margin-left: 15px; height: 40px;">
							<svg xmlns="http://www.w3.org/2000/svg" height="1em"
								viewBox="0 0 384 512">
                                <style>
svg {
	fill: #e8e8e8
}
</style>
                                <path
									d="M48 448V64c0-8.8 7.2-16 16-16H224v80c0 17.7 14.3 32 32 32h80V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16zM64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V154.5c0-17-6.7-33.3-18.7-45.3L274.7 18.7C262.7 6.7 246.5 0 229.5 0H64zm90.9 233.3c-8.1-10.5-23.2-12.3-33.7-4.2s-12.3 23.2-4.2 33.7L161.6 320l-44.5 57.3c-8.1 10.5-6.3 25.5 4.2 33.7s25.5 6.3 33.7-4.2L192 359.1l37.1 47.6c8.1 10.5 23.2 12.3 33.7 4.2s12.3-23.2 4.2-33.7L222.4 320l44.5-57.3c8.1-10.5 6.3-25.5-4.2-33.7s-25.5-6.3-33.7 4.2L192 280.9l-37.1-47.6z" />
                            </svg>
							Xuất Excel
						</button>
						<button class="btn btn-success" onclick="exportToWord()"
							style="margin-left: 15px; height: 40px;">
							<svg xmlns="http://www.w3.org/2000/svg" height="1em"
								viewBox="0 0 384 512">
                                <style>
svg {
	fill: #e8e8e8
}
</style>
                                <path
									d="M48 448V64c0-8.8 7.2-16 16-16H224v80c0 17.7 14.3 32 32 32h80V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16zM64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V154.5c0-17-6.7-33.3-18.7-45.3L274.7 18.7C262.7 6.7 246.5 0 229.5 0H64zm55 241.1c-3.8-12.7-17.2-19.9-29.9-16.1s-19.9 17.2-16.1 29.9l48 160c3 10.2 12.4 17.1 23 17.1s19.9-7 23-17.1l25-83.4 25 83.4c3 10.2 12.4 17.1 23 17.1s19.9-7 23-17.1l48-160c3.8-12.7-3.4-26.1-16.1-29.9s-26.1 3.4-29.9 16.1l-25 83.4-25-83.4c-3-10.2-12.4-17.1-23-17.1s-19.9 7-23 17.1l-25 83.4-25-83.4z" />
                            </svg>
							Xuất Word
						</button>
						<a th:href="@{/admin/employees/addShipper}"
							class="btn btn-success"
							style="float: right; height: 40px; display: flex; align-items: center; justify-content: center;">
							Shipper <i class="icon-plus menu-icon" style="margin-left: 5px;"></i>
						</a>
						<a th:href="@{/admin/employees/addAdmin}"
							class="btn btn-primary"
							style="float: right; height: 40px; display: flex; align-items: center; justify-content: center; margin-right:10px;">
							Admin <i class="icon-plus menu-icon" style="margin-left: 5px;"></i>
						</a>
					</div>
					<div style="padding-left: 10px;">
						<br style="line-height: 0.5;"> 
						<select class="btn btn-secondary" id="roleSelect" name="role"
							style="height: 40px; width: 150px; line-height: 40px; padding: 10px 10px; text-align: center; margin-left: 10px;">
							<option
								style="height: 40px; line-height: 40px; padding: 10px 10px;"
								value="">All Role</option>
							<option
								style="white-space: normal; overflow-wrap: break-word; word-wrap: break-word; height: auto; padding: 10px 10px;"
								th:each="item : ${roles}" th:value="${item.name}"
								th:text="${item.name}"></option>
						</select>
						<select class="btn btn-secondary" id="officeSelect" name="office"
							style="height: 40px; width: 150px; line-height: 40px; padding: 10px 10px; text-align: center; margin-left: 10px;">
							<option
								style="height: 40px; line-height: 40px; padding: 10px 10px;"
								value="">All Office</option>
							<option
								style="white-space: normal; overflow-wrap: break-word; word-wrap: break-word; height: auto; padding: 10px 10px;"
								th:each="item : ${offices}" th:value="${item.officeId}"
								th:text="${item.address}"></option>
						</select>
						<button class="btn btn-info" type="submit"
							style="margin-left: 10px; height: 40px; width:40px; justify-content: center; align-items: center; padding: 0;"><i class="fa fa-filter"></i></button>
					</div>
					<br style="line-height: 0.5;">
					<div class="container-fluid">
						<div th:if="${message != null}">
							<span th:text="${message}" style="color: red;"></span>
						</div>
						<table border="1"
							class="table table-striped table-bordered table-hover"
							id="example1">
							<thead>
								<tr>
									<th>ID</th>
									<th>Full Name</th>
									<th>Email</th>
									<th>Password</th>
									<th>Phone</th>
									<th>Role</th>
									<th>ID Office</th>
									<th>Status</th>
									<th></th>
									<th></th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="item : ${list}">
									<td th:text="${item.userId}"
										style="width: 50px; word-wrap: break-word; white-space: normal;"></td>
									<td th:text="${item.fullname}"
										style="width: auto; word-wrap: break-word; white-space: normal;"></td>
									<td th:text="${item.email}"
										style="width: 80px; word-wrap: break-word; white-space: normal;"></td>
									<td th:text="${item.password}"
										style="width: 120px; word-wrap: break-word; white-space: normal;"></td>
									<td th:text="${item.phone}"
										style="width: 120px; word-wrap: break-word; white-space: normal;"></td>
									<td th:text="${item.name}"
										style="width: 50px; word-wrap: break-word; white-space: normal;"></td>
									<td
										th:text="${item.officeId == null ? '' : item.officeId}"
										style="width: 70px; word-wrap: break-word; white-space: normal;"></td>
									<td th:text="${item.status == null ? '' : item.status}"
										style="width: 70px; word-wrap: break-word; white-space: normal;"></td>
									<td style="width: 80px;"><a class="btn btn-warning"
										style="height: 40px; display: flex; justify-content: center; align-items: center; padding: 0;"
										th:href="@{/admin/employees/detail/{id}(id=${item.userId})}"><i class="icon-eye menu-icon"></i></a>
									</td>
									<td style="width: 80px;"><a class="btn btn-success"
										style="height: 40px; display: flex; justify-content: center; align-items: center; padding: 0;"
										th:href="@{/admin/employees/edit/{id}(id=${item.userId})}"><i class="fa fa-pencil"></i></a>
									</td>
									<td style="width: 80px;"><a class="btn btn-danger"
										style="height: 40px; display: flex; justify-content: center; align-items: center; padding: 0;"
										th:href="@{/admin/employees/delete/{id}(id=${item.userId})}"><i class="icon-trash menu-icon"></i></a>
									</td>
								</tr>
							</tbody>
						</table>
						<br>

						<nav aria-label="Page navigation example" style="float: right;">
							<ul class="pagination">
								<li class="page-item"><a class="page-link"
									th:href="@{'?pageNo=' + ${currentPage - 1}}"
									th:if="${currentPage > 1}"
									style="border-radius: 50%; font-size: 12px; padding: 5px 10px;">Previous</a></li>
								<li class="page-item"
									th:each="i:${#numbers.sequence(1, totalPage)}"
									th:classappend="${currentPage == i ? 'active' : ''}"><a
									class="page-link" th:href="@{'?pageNo=' + ${i}}" th:text="${i}"
									style="border-radius: 50%; font-size: 12px; padding: 5px 10px;"></a>
								</li>
								<li class="page-item"><a class="page-link"
									th:href="@{'?pageNo=' + ${currentPage + 1}}"
									th:if="${currentPage < totalPage}"
									style="border-radius: 50%; font-size: 12px; padding: 5px 10px;">Next</a></li>
							</ul>
						</nav>

					</div>
				</div>
			</form>
		</div>
		<script>
			function exportToExcel() {
				var tableClone = $('#example1').clone();
				tableClone.find('tr').each(function() {
					$(this).find('th:last, td:last').remove();
					$(this).find('th:last, td:last').remove();
					$(this).find('th:last, td:last').remove();
				});
				var wb = XLSX.utils.table_to_book(tableClone[0], {
					sheet : "Sheet JS"
				});
				XLSX.writeFile(wb, "DanhSachNhanVien.xlsx");
			}
			function exportToWord() {
				var tableClone = $('#example1').clone();
				tableClone.find('tr').each(function() {
					$(this).find('th:last, td:last').remove();
					$(this).find('th:last, td:last').remove();
					$(this).find('th:last, td:last').remove();
				});
				var newHtml = tableClone.prop('outerHTML');
				var blob = new Blob([ '\ufeff', newHtml ], {
					type : 'application/msword'
				});
				var url = URL.createObjectURL(blob);
				var a = document.createElement('a');
				a.href = url;
				a.download = 'DanhSachNhanVien.doc';
				document.body.appendChild(a);
				a.click();
				document.body.removeChild(a);
				URL.revokeObjectURL(url);
			}
		</script>
	</section>
</body>